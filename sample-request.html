<html>
<head>
    <title>Sample Request with PPID</title>
</head>
<body>
    <div id="id-1" style="width:100px;height:100px;background-color:aquamarine;margin:5px;"></div>
    <div id="id-2" style="width:100px;height:100px;background-color:bisque;margin:5px;"></div>
    <div id="id-3" style="width:100px;height:100px;background-color:thistle;margin:5px;"></div>
    <script src="./build/dev/prebid.js"></script>
    <script>
        // Define your ad unit configuration
        var adUnits = [
            {
                code: '/46753895/de-20minuten.ch/inside-full-content-pos1/ostschweiz',
                mediaTypes: {
                    banner: {
                        sizes: [[300, 50], [300, 250], [300, 600], [320, 50], [320, 480], [320, 64], [320, 160], [320, 416], [336, 280]]
                    }
                },
                bids: [
                    {
                        bidder: 'goldbach',
                        params: {
                            publisherId: 'de-20minuten.ch_ios_debug',
                        }
                    }
                ]
            },
            {
                code: '/46753895/de-20minuten.ch/inside-full-content-pos/reporterin',
                mediaTypes: {
                    video: {
                        sizes: [[300,50],[300,250],[320,180]],
                        context: 'outstream',
                        //playerSize: [640, 480],
                        mimes: ['video/mp4'],
                        protocols: [1, 2, 3, 4, 5, 6, 7, 8],
                        playbackmethod: [2],
                        skip: 1,
                        playback_method: ['auto_play_sound_off']
                    }
                },
                bids: [
                    {
                        bidder: 'goldbach',
                        params: {
                            publisherId: 'de-20minuten.ch_ios',
                            customTargeting: {
                                gpsenabled: "false",
                                fr: "false",
                                pagetype: "story",
                                darkmode: "false",
                                userloggedin: "false",
                                iosbuild: "24110",
                                language: "de",
                                storyId: "103211763",
                                connection: "wifi"
                            }
                        }
                    }
                ]
            }
        ];

        // Set Prebid configurations with PPID (Publisher Provided Identifier) support
        pbjs.setConfig({
            debug: true,
            cache: {
                url: 'https://prebid.adnxs.com/pbc/v1/cache'
            },
            ortb2: {
                device: {
                    ifa: "23575619-ef35-4908-b468-ffc4000cdf07",
                    geo: {
                        lat: 47.318054,
                        lon: 8.582883,
                        zip: "8700"
                    },
                    connectiontype: 6
                }
            },
            timeout: 2000,
            userSync: {
                userIds: [
                    {
                        name: "pubProvidedId",
                        params: {
                            eids: [
                                {
                                    source: "oneid.live",
                                    uids: [
                                        {
                                            id: "0d862e87-14e9-47a4-9e9b-886b7d7a9d3b",
                                            atype: 1,
                                            ext: {
                                                stype: "ppuid"
                                            }
                                        }
                                    ]
                                },
                                {
                                    source: "goldbach.com",
                                    uids: [
                                        {
                                            id: "aa07ead5044f47bb28894ffa0346ed4c",
                                            atype: 1,
                                            ext: {
                                                stype: "ppuid"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                ],
                auctionDelay: 50
            }
        });

        // Initialize ad units with Prebid
        pbjs.addAdUnits(adUnits);

        // Request bids and render the highest bid
        pbjs.requestBids({
            bidsBackHandler: function (bids) {
                pbjs.getHighestCpmBids().forEach(function (bid, index) {
                    const adUnitElement = document.getElementById(`id-${index + 1}`);
                    if (adUnitElement) {
                        const iframe = document.createElement('iframe');
                        iframe.id = `iframe-${index + 1}`;
                        adUnitElement.style.width = iframe.style.width = `${bid.width}px`;
                        adUnitElement.style.height = iframe.style.height = `${bid.height}px`;
                        adUnitElement.style.padding = iframe.style.padding = '0';
                        iframe.style.border = 'none';
                        adUnitElement.appendChild(iframe);
                        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                        pbjs.renderAd(iframeDoc, bid.adId, {});
                    }
                });
            }
        });

    </script>
</body>
</html>
